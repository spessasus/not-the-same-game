var $={localeName:"English",gameTitle:"Not The Same Game",author:"Created by spessasus",notFinished:"v1.0.0-initial",menuButtons:{newGame:"New Game",showScores:"Show Scores",selectedLanguage:"Selected Language: "},difficultySelector:{prompt:"Select Difficulty",easy:"Easy",medium:"Medium",hard:"Hard",extreme:"Extreme"},goBack:"Back to main menu",gameOver:{title:"Game Over",message:"Game over! Your final score was {0}",difficulty:"Difficulty: {0}",question:"Would you like to save your score?",yes:"Save",cancel:"Cancel",save:{title:"Save your score",name:"Name: ",score:"Score: {0}",date:"Date: {0}"}},showScores:{prompt:"Top Scores",name:"Name",score:"Score",date:"Date",nothing:"Nothing to show here...",clear:{button:"Clear all scores",prompt:{title:"Score deletion warning",question:"Are you sure you want to delete ALL Scores? This cannot be undone!"}}},game:{score:"Current score:",clickScore:"This click's score:",moves:"Moves: "},yes:"Yes",no:"No"};var H={localeName:"Polski",gameTitle:"Not The Same Game",author:"Autorstwa spessasus",notFinished:"v1.0.0-initial",menuButtons:{newGame:"Nowa gra",showScores:"Poka\u017C wyniki",selectedLanguage:"Wybrany j\u0119zyk: "},difficultySelector:{prompt:"Wybierz poziom trudno\u015Bci",easy:"\u0141atwy",medium:"\u015Aredni",hard:"Trudny",extreme:"Ekstremalny"},goBack:"Powr\xF3t do menu g\u0142\xF3wnego",gameOver:{title:"Koniec gry",message:"Koniec gry! Tw\xF3j ko\u0144cowy wynik to {0}",difficulty:"Poziom trudno\u015Bci: {0}",question:"Czy chcesz zapisa\u0107 sw\xF3j wynik?",yes:"Zapisz",cancel:"Anuluj",save:{title:"Zapisz sw\xF3j wynik",name:"Imi\u0119: ",score:"Wynik: {0}",date:"Data: {0}"}},showScores:{prompt:"Najlepsze wyniki",name:"Imi\u0119",score:"Wynik",date:"Data",nothing:"Nie ma tu nic do pokazania...",clear:{button:"Wyczy\u015B\u0107 wszystkie wyniki",prompt:{title:"Ostrze\u017Cenie o usuni\u0119ciu wynik\xF3w",question:"Jeste\u015B pewien, \u017Ce chcesz usun\u0105\u0107 wszystkie wyniki? Tego nie mo\u017Cna cofn\u0105\u0107!"}}},game:{score:"Aktualny wynik:",clickScore:"Wynik tego ruchu:",moves:"Ruchy: "},yes:"Tak",no:"Nie"};var y={en:$,pl:H},Y="en";var N=class{onLocaleChanged=[];constructor(e){this.locale=y[e]||y[Y],this.fallbackLocale=y[Y],this.localeCode=e,this._boundObjectProperties=[]}getLocaleString(e,t=[]){let i=this._resolveLocalePath(e);return t.length>0?this._formatLocale(i,t):i}_applyPropertyInternal(e){if(e.isEdited)return;let t=this._resolveLocalePath(e.localePath);e.formattingArguments.length>0&&(t=this._formatLocale(t,e.formattingArguments)),e.object[e.propertyName]=t}_validatePropertyIntegrity(e){let t=this._resolveLocalePath(e.localePath);e.formattingArguments.length>0&&(t=this._formatLocale(t,e.formattingArguments)),e.object[e.propertyName]!==t&&(e.isEdited=!0)}_formatLocale(e,t){return e.replace(/{(\d+)}/g,(i,o)=>typeof t[o]<"u"?t[o]:i)}bindObjectProperty(e,t,i,o=[]){let s={object:e,propertyName:t,localePath:i,formattingArguments:o,isEdited:!1};this._applyPropertyInternal(s),this._boundObjectProperties.push(s)}_resolveLocalePath(e,t=!1){if(!e.startsWith("locale."))throw new Error(`Invalid locale path: ${e} (it should start with "locale.")`);let i=e.split("."),o=t?this.fallbackLocale:this.locale;for(let s=1;s<i.length;s++)if(o[i[s]]!==void 0)o=o[i[s]];else{if(t)throw new Error(`Invalid locale path: ${e}: part "${i[s]}" does not exist. Available paths: ${Object.keys(o).join(", ")}`);return this._resolveLocalePath(e,!0)}if(typeof o!="string")throw new Error(`Invalid locale path: ${e}: value is not a string. Perhaps the path is incomplete`);return o}changeGlobalLocale(e,t=!1){document.documentElement.lang=e;let i=y[e];if(!i){console.warn(`Locale ${e} not found. Not switching.`);return}this.localeCode=e,console.info("Changing locale to",i.localeName),t||this._boundObjectProperties.forEach(o=>{this._validatePropertyIntegrity(o)}),this.locale=i,this._boundObjectProperties.forEach(o=>{this._applyPropertyInternal(o)}),this.onLocaleChanged.forEach(o=>o())}};async function p(n,e){let t=document.getElementById("content");t.classList.add("gone"),await new Promise(i=>setTimeout(i,600)),n.classList.add("hidden"),e.classList.remove("hidden"),t.classList.remove("gone"),await new Promise(i=>setTimeout(i,600))}function T(){let n=localStorage.getItem("scores_json");return n?JSON.parse(n):[]}function O(n){let e=JSON.stringify(n);localStorage.setItem("scores_json",e)}function w(n,e,t){if(e.textContent&&(n.textContent=e.textContent),e.translatePathTitle){if(!t)throw new Error("Translate path title provided but no locale provided.");t.bindObjectProperty(n,"textContent",e.translatePathTitle+".title",e?.translatePathTitleProps),t.bindObjectProperty(n,"title",e.translatePathTitle+".description",e?.translatePathTitleProps)}}function q(n,e){switch(n.type){case"button":let t=document.createElement("button");return w(t,n,e),E(n,[t]),t;case"text":let i=document.createElement("p");return w(i,n,e),E(n,[i]),i;case"input":let o=document.createElement("div");o.classList.add("notification_input_wrapper");let s=document.createElement("input");w(s,n,e),s.addEventListener("keydown",B=>B.stopPropagation());let r=document.createElement("label");return w(r,n,e),E(n,[s,r]),o.append(r),o.appendChild(s),o;case"select":let l=document.createElement("div");l.classList.add("notification_input_wrapper");let a=document.createElement("select");if(n.selectOptions===void 0)throw new Error("Select but no options given?");for(let B of Object.entries(n.selectOptions)){let F=document.createElement("option");F.value=B[0],F.textContent=B[1],a.appendChild(F)}let m=document.createElement("label");return w(m,n,e),E(n,[a,m]),l.appendChild(m),l.appendChild(a),l;case"file":let f=document.createElement("label");f.classList.add("notification_input_wrapper");let c=document.createElement("input");c.type="file";let d=document.createElement("label");d.classList.add("notification_file_button"),w(d,n,e);let h=document.createElement("label");return w(h,n,e),E(n,[d,c,h]),d.appendChild(c),f.append(h),f.appendChild(d),f;case"progress":let b=document.createElement("div");b.classList.add("notification_progress_background");let R=document.createElement("div");return R.classList.add("notification_progress"),E(n,[R,b]),b.appendChild(R),b;case"toggle":return ne(n,e);case"range":throw"No range here!"}}function E(n,e){if(n.attributes)for(let[t,i]of Object.entries(n.attributes))for(let o of e)t.startsWith("onchange")?o[t]=i:o.setAttribute(t,i);if(n.listeners)for(let[t,i]of Object.entries(n.listeners))for(let o of e)o.addEventListener(t,i)}function ne(n,e){let t=document.createElement("label");t.classList.add("notification_switch_wrapper");let i=document.createElement("label");w(i,n,e);let o=document.createElement("input");o.type="checkbox",E(n,[i,o]);let s=document.createElement("div");s.classList.add("notification_switch"),s.appendChild(o);let r=document.createElement("div");return r.classList.add("notification_switch_slider"),s.appendChild(r),t.appendChild(i),t.appendChild(s),t}var J=50,se=13,re=0,k={};function v(n,e,t=se,i=!0,o=void 0,s=void 0,r=void 0){let l=document.createElement("div"),a=re++;l.classList.add("notification"),l.innerHTML=`
    <div class='top'>
        <h2 class='notification_title'>${n}</h2>
        <span class='close_btn'>\xD7</span>
    </div>`;let m=document.createElement("div");if(m.classList.add("notification_content"),s)for(let[c,d]of Object.entries(s))m.style[c]=d;l.appendChild(m);for(let c of e){let d=q(c,o);c.onClick&&(d.onclick=()=>c.onClick({div:l,id:a},d)),m.appendChild(d)}i?l.getElementsByClassName("close_btn")[0].onclick=()=>{g(a)}:l.getElementsByClassName("close_btn")[0].style.display="none",setTimeout(()=>{l.classList.add("drop")},J);let f=setTimeout(()=>{g(a)},t*1e3+J);return document.getElementsByClassName("notification_field")[0].appendChild(l),k[a]={div:l,timeout:f,onclose:r},{div:l,id:a}}function g(n){if(k[n]===void 0)return;let e=k[n],t=e.div;clearTimeout(k[n].timeout),t.classList.remove("drop"),setTimeout(()=>t.parentElement.removeChild(t),500),e.onclose&&e.onclose(),k[n]=void 0}var u={easy:3,medium:4,hard:5,extreme:6};function S(n,e){let t=document.getElementById("score_table");for(;t.children.length>1;)t.removeChild(t.lastChild);if(n.length===0){let i=document.createElement("tr"),o=document.createElement("td");i.appendChild(o),o.classList.add("nothing_to_show"),o.colSpan=3,e.bindObjectProperty(o,"textContent","locale.showScores.nothing"),t.appendChild(i)}else{n.sort((i,o)=>o.score-i.score);for(let i of n){let o=document.createElement("tr"),s=document.createElement("td");s.textContent=i.name;let r=document.createElement("td");r.textContent=i.score.toString();let l=document.createElement("td");l.textContent=i.date,o.appendChild(s),o.appendChild(r),o.appendChild(l),t.appendChild(o)}}}function U(n){p(document.getElementById("main_menu"),document.getElementById("scores_display")).then();let e=T();S(e,n),document.getElementById("easy_scores").onclick=()=>S(e.filter(t=>t.difficulty===u.easy),n),document.getElementById("medium_scores").onclick=()=>S(e.filter(t=>t.difficulty===u.medium),n),document.getElementById("hard_scores").onclick=()=>S(e.filter(t=>t.difficulty===u.hard),n),document.getElementById("extreme_scores").onclick=()=>S(e.filter(t=>t.difficulty===u.extreme),n),document.getElementById("clear_scores").onclick=()=>{v(n.getLocaleString("locale.showScores.clear.prompt.title"),[{type:"text",textContent:n.getLocaleString("locale.showScores.clear.prompt.question")},{type:"button",textContent:n.getLocaleString("locale.yes"),onClick:t=>{O([]),g(t.id),p(document.getElementById("scores_display"),document.getElementById("main_menu")).then()}},{type:"button",textContent:n.getLocaleString("locale.no"),onClick:t=>{g(t.id)}}])},document.getElementById("back_to_main").onclick=()=>{p(document.getElementById("scores_display"),document.getElementById("main_menu")).then()}}function le(){let n=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}var I=le();function _(n,e){let t=n.replace(/[^\d,]/g,"").split(",");return`rgb(${e(parseInt(t[0]))}, ${e(parseInt(t[1]))}, ${e(parseInt(t[2]))})`}var j=class{isEmpty=!0;offsetX=0;offsetY=0;color="";colorID;bright=!1;setColor(e,t){this.isEmpty=!1,this.color=e,this.colorID=t}empty(){this.isEmpty=!0,this.color="",this.colorID=-1,this.offsetX=0,this.offsetY=0}colorMatches(e){return this.colorID===e&&!this.isEmpty}transferFrom(e){this.isEmpty=!1,this.color=e.color,this.colorID=e.colorID,this.offsetX=e.offsetX,this.offsetY=e.offsetY,e.empty()}getColor(){return this.bright?this.color:_(this.color,e=>e*.8)}};var C=3,V=.8,z=class{field=[];rows;columns;constructor(e,t){this.rows=e,this.columns=t;for(let i=0;i<e;i++){this.field.push([]);for(let o=0;o<t;o++)this.field[i].push(new j)}}getXpos(e,t){return Math.floor(e/t*this.rows)}getYpos(e,t){return Math.floor(e/t*this.columns)}isEmpty(e,t){return this.field[e][t].isEmpty}getField(e,t){return this.field[e][t]}initialize(e){for(let t=0;t<this.field.length;t++)for(let i of this.field[t]){let o=Math.floor(Math.random()*e.length);i.setColor(e[o],o)}}clearHighlights(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.field[e][t].bright=!1}highlightField(e,t){this.field[e][t].bright=!0}getGroupList(e,t,i=new Set){if(this.getField(e,t).isEmpty)return i;let o=this.getField(e,t).colorID;if(i.has(`${e} ${t}`))return i;i.add(`${e} ${t}`);let s=(r,l)=>{l<0||l>=this.columns||r<0||r>=this.rows||this.field[r][l].colorMatches(o)&&(i=this.getGroupList(r,l,i))};return s(e-1,t),s(e+1,t),s(e,t-1),s(e,t+1),i}click(e,t){if(this.isEmpty(e,t))return!1;let i=this.getGroupList(e,t);return i.size<2?!1:(i.forEach(o=>{let s=parseInt(o.split(" ")[0]),r=parseInt(o.split(" ")[1]);this.field[s][r].empty()}),!0)}clearOffsets(){this.field.forEach(e=>e.forEach(t=>{t.offsetY=0,t.offsetX=0}))}computeColumnsFall(e){for(let t=0;t<this.rows;t++){let i=0;for(let o=this.columns-1;o>=0;o--)if(this.isEmpty(t,o))i+=1;else{if(i<1)continue;let s=this.getField(t,o+i);s.transferFrom(this.getField(t,o)),s.offsetY-=e*i,o+=i,i=0}}}columnEmpty(e){for(let t=0;t<this.columns;t++)if(!this.isEmpty(e,t))return!1;return!0}moveColumnLeft(e,t,i){for(let o=0;o<this.columns;o++)if(!this.getField(e,o).isEmpty){let r=this.getField(e-i,o);r.transferFrom(this.getField(e,o)),r.offsetX+=t*i}}computeRowsMoving(e){let t=0;for(let i=0;i<this.rows;i++)if(this.columnEmpty(i))t+=1;else{if(t<1)continue;this.moveColumnLeft(i,e,t),i-=t,t=0}}isFieldEmpty(){for(let e of this.field)for(let t of e)if(!t.isEmpty)return!1;return!0}isGameOver(){if(this.isFieldEmpty())return!0;for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++){if(this.isEmpty(e,t))continue;if(this.getGroupList(e,t).size>1)return!1}return!0}drawRegularBall(e,t,i,o,s){let r=this.getField(e,t),l=i*e+r.offsetX,a=o*t+r.offsetY;s.fillStyle=r.getColor(),s.beginPath(),s.ellipse(l+i/2,a+o/2,i/2-C*2,o/2-C*2,0,0,Math.PI*2),s.closePath(),s.fill()}drawHighlightedBall(e,t,i,o,s){let r=this.getField(e,t),l=i*e+r.offsetX,a=o*t+r.offsetY,m=i/2-C*2,f=o/2-C*2,c=m*V,d=f*V;s.fillStyle=_(r.getColor(),h=>h*.8),s.beginPath(),s.ellipse(l+i/2,a+o/2,m,f,0,0,Math.PI*2),s.closePath(),s.fill(),s.fillStyle=_(r.getColor(),h=>h*1.3),s.beginPath(),s.ellipse(l+i/2,a+o/2,c-C*2,d-C*2,0,0,Math.PI*2),s.closePath(),s.fill()}renderGame(e,t){t.clearRect(0,0,e.width,e.height);let i=e.width/this.rows,o=e.height/this.columns;for(let s=0;s<this.rows;s++)for(let r=0;r<this.columns;r++)this.field[s][r].isEmpty||(this.field[s][r].bright?this.drawHighlightedBall(s,r,i,o,t):this.drawRegularBall(s,r,i,o,t))}};var X=["rgba(255, 99, 71, 1)","rgba(0, 255, 255, 1)","rgba(255, 165, 0, 1)","rgba(0, 128, 0, 1)","rgba(75, 0, 130, 1)","rgba(255, 20, 147, 1)","rgba(255, 105, 180, 1)","rgba(0, 0, 255, 1)","rgba(255, 255, 255, 1)"];var A=class{constructor(){this.transitions={}}createTransition=(e,t,i,o=1e3,s=void 0,r=void 0,l=!1,a=!0,m=0,f="sin")=>{let c=t;if(this.transitions[e])if(l)a&&(c=this.transitions[e].current),delete this.transitions[e];else return;let d={initial:t,target:i,current:c,time:o,start:performance.now()+m,type:f};s&&(d.callback=s),r&&(d.finish=r),this.transitions[e]=d};performTransitions=()=>{for(let e of Object.entries(this.transitions)){let t=e[1];if(!t||t.start>performance.now())continue;if(performance.now()-t.start>=t.time){t.callback&&t.callback(t.current),t.finish&&t.finish(t.current),delete this.transitions[e[0]];continue}let i=t.target-t.initial,o=(performance.now()-t.start)/t.time;if(t.type==="sin"){let r=Math.PI/2*(o-.5)*2,l=Math.sin(r);t.current=(l+1)/2*i+t.initial}else t.current=o*i+t.initial;t.callback&&t.callback(t.current)}};deleteTransition=e=>{delete this.transitions[e]}};var W=300,D=class{currentScore=0;currentRawScore=0;moveCount=0;currentClickScore=0;field;difficulty;canv;ctx;suspended=!1;onvictory;constructor(e,t,i,o,s){this.field=new z(e,t),this.difficulty=i,this.ctx=s,this.canv=o,this.isGame=!0,this.transitions=new A;let r=new Set;for(;r.size<i;)r.add(X[Math.floor(Math.random()*X.length)]);this.field.initialize(Array.from(r)),this.scoreDisplay=document.getElementById("game_score"),this.clickScoreDisplay=document.getElementById("game_click_score"),this.moveDisplay=document.getElementById("game_moves"),this.lastHighlightRow=-1,this.lastHighlightCol=-1,this.updateScore(),this.tick(),setTimeout(()=>{this.canv.onpointermove=this.handlePointerMove.bind(this),this.canv.onclick=this.handleClick.bind(this)},1e3)}tick(){this.isGame&&(this.transitions.performTransitions(),this.field.renderGame(this.canv,this.ctx),requestAnimationFrame(this.tick.bind(this)))}highlightClick(e,t){let i=this.field.getGroupList(e,t);return this.currentClickScore=i.size>1?(i.size-2)*(i.size-2):0,this.updateScore(),this.field.clearHighlights(),i.forEach(o=>{let s=o.split(" ");this.field.highlightField(parseInt(s[0]),parseInt(s[1]))}),i.size}handlePointerMove(e){if(this.suspended)return;let t=e.offsetX,i=e.offsetY,o=this.canv.getBoundingClientRect(),s=o.width,r=o.height,l=this.field.getXpos(t,s),a=this.field.getYpos(i,r);if(this.field.isEmpty(l,a)){this.currentClickScore=0,this.updateScore(),this.field.clearHighlights();return}this.lastHighlightRow===l&&this.lastHighlightCol===a||(this.highlightClick(l,a),this.lastHighlightRow=l,this.lastHighlightCol=a)}calculateScore(){let e=this.currentRawScore;this.currentScore=Math.floor(e*100)/100}handleClick(e){if(this.suspended)return;let t=e.offsetX,i=e.offsetY,o=this.canv.getBoundingClientRect(),s=o.width,r=o.height,l=this.field.getXpos(t,s),a=this.field.getYpos(i,r);if(this.highlightClick(l,a),!this.field.click(l,a))return;this.suspended=!0,this.moveCount+=1,this.currentRawScore+=this.currentClickScore,this.calculateScore(),this.currentClickScore=0,this.updateScore(),this.field.clearHighlights();let m=this.canv.width/this.field.rows,f=this.canv.height/this.field.columns;this.field.clearOffsets(),this.field.computeColumnsFall(f),this.field.computeRowsMoving(m);for(let c=0;c<this.field.rows;c++)for(let d=0;d<this.field.columns;d++){let h=this.field.getField(c,d);h.offsetY!==0&&this.transitions.createTransition(`fall${c}_${d}`,h.offsetY,0,W,b=>h.offsetY=b,void 0,!0,!1,0,"sin"),h.offsetX!==0&&this.transitions.createTransition(`move${c}_${d}`,h.offsetX,0,W,b=>h.offsetX=b,void 0,!0,!1,0,"sin")}this.suspended=!1,setTimeout(()=>{this.suspended=!1,this.field.isGameOver()&&(console.log("GAME OVER"),this.suspended=!0,this.isGame=!1,this.onvictory(this.currentScore))},W)}updateScore(){this.scoreDisplay.textContent=this.currentScore.toString(),this.moveDisplay.textContent=this.moveCount.toString(),this.clickScoreDisplay.textContent=this.currentClickScore.toString()}};function K(n,e,t){let i="locale.gameOver.",o=Object.keys(u).find(l=>u[l]===e),s=t.getLocaleString(`locale.difficultySelector.${o}`),r=new Date().toDateString();v(t.getLocaleString(i+"save.title"),[{type:"input",attributes:{"name-input":"1",type:"text"},textContent:t.getLocaleString(i+"save.name")},{type:"text",textContent:t.getLocaleString(i+"save.score",[n])},{type:"text",textContent:t.getLocaleString(i+"difficulty",[s])},{type:"text",textContent:t.getLocaleString(i+"save.date",[r])},{type:"button",textContent:t.getLocaleString(i+"yes"),onClick:l=>{let a=T(),m=l.div.querySelector("input[name-input]").value;console.log(m),a.push({name:m,score:n,difficulty:e,date:r}),console.log(a),O(a),g(l.id),p(document.getElementById("game"),document.getElementById("main_menu")).then()}},{type:"button",textContent:t.getLocaleString(i+"cancel"),onClick:l=>{g(l.id),p(document.getElementById("game"),document.getElementById("main_menu")).then()}}],999999)}var L=document.getElementById("game_canvas"),ae=L.getContext("2d");I&&L.classList.add("mobile");var Z=1920,Q=1280,ee=15,te=10;function x(n,e){p(document.getElementById("difficulty_menu"),document.getElementById("game")).then();let t,i,o,s;I?(i=Z,t=Q,o=te,s=ee):(i=Q,t=Z,o=ee,s=te),L.width=t,L.height=i,console.log(o,s);let r=new D(o,s,n,L,ae);r.onvictory=l=>{let a="locale.gameOver.",m=Object.keys(u).find(c=>u[c]===n),f=e.getLocaleString(`locale.difficultySelector.${m}`);v(e.getLocaleString(a+"title"),[{type:"text",textContent:e.getLocaleString(a+"message",[l])},{type:"text",textContent:e.getLocaleString(a+"difficulty",[f])},{type:"text",textContent:e.getLocaleString(a+"question")},{type:"button",textContent:e.getLocaleString(a+"yes"),onClick:c=>{g(c.id),K(l,n,e)}},{type:"button",textContent:e.getLocaleString(a+"cancel"),onClick:c=>{g(c.id),p(document.getElementById("game"),document.getElementById("main_menu")).then()}}],9999999,e)}}function ie(n){document.getElementById("new_game").onclick=()=>{p(document.getElementById("main_menu"),document.getElementById("difficulty_menu")).then(),document.getElementById("easy").onclick=()=>x(u.easy,n),document.getElementById("medium").onclick=()=>x(u.medium,n),document.getElementById("hard").onclick=()=>x(u.hard,n),document.getElementById("extreme").onclick=()=>x(u.extreme,n),document.getElementById("go_back").onclick=()=>p(document.getElementById("difficulty_menu"),document.getElementById("main_menu")).then()},document.getElementById("show_scores").onclick=U.bind(this,n)}var M="en";for(let n of navigator.languages)y[n]!==void 0&&(M=n);var oe=localStorage.getItem("language");oe!==null&&(M=oe);var G=new N(M);for(let n of document.querySelectorAll("*"))n.hasAttribute("translate-path")&&G.bindObjectProperty(n,"textContent",n.getAttribute("translate-path"));var P=document.getElementById("language_select");for(let n of Object.keys(y)){let e=document.createElement("option"),t=document.createElement("span");G.bindObjectProperty(t,"textContent","locale.menuButtons.selectedLanguage");let i=document.createElement("span");i.textContent=y[n].localeName,e.value=n,e.appendChild(t),e.appendChild(i),P.appendChild(e)}P.value=M;P.onchange=()=>{G.changeGlobalLocale(P.value),localStorage.setItem("language",P.value)};I||document.getElementsByClassName("main")[0].classList.add("pc");ie(G);
